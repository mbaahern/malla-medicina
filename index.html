<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Malla Curricular Interactiva</title>

    <!-- Tailwind CSS via CDN (JIT activo por defecto en el play CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      /* Config opcional para refinar la paleta vibrante en tonos rosados y morados */
      tailwind.config = {
        theme: {
          extend: {
            boxShadow: {
              glow: "0 0 0 3px rgba(236,72,153,.25)", // rosa-500 suave
            },
          },
        },
      };
    </script>

    <style>
      /* Micro-tuning accesibilidad: respetar focus visible */
      :focus:not(:focus-visible) { outline: none; }
    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-pink-50 via-rose-50 to-purple-50 text-gray-800">
    <header class="sticky top-0 z-10 backdrop-blur bg-white/60 border-b border-pink-100">
      <div class="mx-auto max-w-7xl px-4 py-6">
        <h1 class="text-2xl sm:text-3xl font-semibold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-pink-600 via-rose-600 to-purple-700">
          Malla Curricular Interactiva
        </h1>
        <p className="mt-2 text-sm sm:text-base text-purple-900/80">
          Marca los ramos <span class="font-medium">aprobados</span> para desbloquear autom√°ticamente sus <span class="font-medium">prerrequisitos dependientes</span>.
        </p>
      </div>
    </header>

    <main id="root" class="mx-auto max-w-7xl px-4 py-8"></main>

    <!-- React 18 + ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel Standalone para permitir JSX sin build tools -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- App React (JSX con Babel) -->
    <script type="text/babel">
      /* =========================================================================
         ‚öôÔ∏è ESTRUCTURA DE DATOS
         -------------------------------------------------------------------------
         A continuaci√≥n se define tu malla en el array `initialCourses`.
         Si deseas editarla en el futuro, modifica los objetos manteniendo el formato:
           { id: "COD123", name: "Nombre del ramo", prereqs: ["ID1","ID2"], semester: 1 }
         - `id`: identificador √∫nico (usa el mismo en `prereqs`)
         - `name`: nombre del ramo
         - `prereqs`: array de IDs requeridos
         - `semester`: n√∫mero de semestre (A√±os 5‚Äì7 se mapearon a 9‚Äì11)
         ========================================================================= */

      const initialCourses = [
        // =========================
        // Semestre 1
        // =========================
        { id: "MED016", name: "Introducci√≥n a la Medicina I", prereqs: [], semester: 1 },
        { id: "FMM007", name: "Matem√°ticas avanzada", prereqs: [], semester: 1 },
        { id: "QUI109", name: "Qu√≠mica General", prereqs: [], semester: 1 },
        { id: "BIO130", name: "Biolog√≠a celular", prereqs: [], semester: 1 },
        { id: "BIO131", name: "Laboratorio Biolog√≠a Celular", prereqs: [], semester: 1 },
        { id: "CEG001", name: "Electivo de Formaci√≥n General", prereqs: [], semester: 1 },

        // =========================
        // Semestre 2
        // =========================
        { id: "MED017", name: "Introducci√≥n a la Medicina II", prereqs: ["MED016"], semester: 2 },
        { id: "FMF019", name: "F√≠sica", prereqs: ["FMM007"], semester: 2 },
        { id: "QUI024", name: "Qu√≠mica org√°nica", prereqs: ["QUI109"], semester: 2 },
        { id: "MOR330", name: "Anatom√≠a Humana I", prereqs: [], semester: 2 },
        { id: "MOR331", name: "Laboratorio de Anatom√≠a Humana I", prereqs: [], semester: 2 },
        { id: "CEG002", name: "Electivo de Formaci√≥n General", prereqs: [], semester: 2 },

        // =========================
        // Semestre 3
        // =========================
        { id: "MED121", name: "M√©dico Paciente", prereqs: ["MED017"], semester: 3 },
        { id: "BIO376", name: "Fisiolog√≠a Humana I", prereqs: ["BIO130", "BIO131", "FMF019", "MOR330", "MOR331"], semester: 3 },
        { id: "BIO266", name: "Bioqu√≠mica", prereqs: ["QUI024"], semester: 3 },
        { id: "MOR332", name: "Anatom√≠a Humana II", prereqs: ["MOR330"], semester: 3 },
        { id: "MOR333", name: "Laboratorio de Anatom√≠a Humana II", prereqs: ["MOR331"], semester: 3 },
        { id: "HUF124", name: "Antropolog√≠a Filos√≥fica", prereqs: [], semester: 3 },

        // =========================
        // Semestre 4
        // =========================
        { id: "MED122", name: "M√©dico Paciente II", prereqs: ["MED121"], semester: 4 },
        { id: "BIO377", name: "Fisiolog√≠a Humana II", prereqs: ["BIO376"], semester: 4 },
        { id: "BIO148", name: "Gen√©tica y Biolog√≠a Molecular Humana", prereqs: ["BIO130", "BIO131"], semester: 4 },
        { id: "BIO242", name: "Lab. y Sem. de Gen√©tica y Biolog√≠a Molecular Humana", prereqs: ["BIO130", "BIO131"], semester: 4 },
        { id: "BIO320", name: "Histolog√≠a", prereqs: ["MOR332", "MOR333", "BIO130", "BIO131"], semester: 4 },
        { id: "BIO321", name: "Laboratorio de Histolog√≠a", prereqs: ["MOR332", "MOR333", "BIO130", "BIO131"], semester: 4 },
        { id: "MED131", name: "Psicolog√≠a", prereqs: [], semester: 4 },
        { id: "CEG003", name: "Electivo de Formaci√≥n General III", prereqs: [], semester: 4 },

        // =========================
        // Semestre 5
        // =========================
        { id: "MED250", name: "Semiolog√≠a M√©dica", prereqs: ["BIO377", "MED122", "BIO320", "BIO321"], semester: 5 },
        { id: "MED257", name: "Inmunolog√≠a y Nutrici√≥n", prereqs: ["BIO377", "BIO320", "BIO321", "BIO266"], semester: 5 },
        { id: "BIO250", name: "Microbiolog√≠a", prereqs: ["BIO148"], semester: 5 },
        { id: "BIO251", name: "Laboratorio de Microbiolog√≠a", prereqs: ["BIO242"], semester: 5 },
        { id: "MED258", name: "√âtica M√©dica I", prereqs: ["MED122"], semester: 5 },
        { id: "MED278", name: "T√≥picos de investigaci√≥n en salud I", prereqs: ["FMM007", "FMF019"], semester: 5 },

        // =========================
        // Semestre 6
        // =========================
        { id: "MED249", name: "Medicina Orientada al Problema", prereqs: ["MED250"], semester: 6 },
        { id: "MED260", name: "Fisiopatolog√≠a Humana", prereqs: ["BIO377"], semester: 6 },
        { id: "BIO288", name: "Farmacolog√≠a", prereqs: ["BIO266", "BIO377"], semester: 6 },
        { id: "MED259", name: "√âtica M√©dica II", prereqs: ["MED258"], semester: 6 },
        { id: "MED279", name: "T√≥picos de investigaci√≥n en salud II", prereqs: ["MED278"], semester: 6 },

        // =========================
        // Semestre 7
        // =========================
        { id: "MED296", name: "Medicina Interna (Anual)", prereqs: ["MED249", "MED260", "BIO288", "MED257"], semester: 7 },
        { id: "MED287", name: "Cirug√≠a (Anual)", prereqs: ["MED260", "BIO288"], semester: 7 },
        { id: "MED244", name: "Neurolog√≠a", prereqs: ["MED249", "BIO288"], semester: 7 },
        { id: "MED294", name: "Patolog√≠a I", prereqs: ["BIO320", "BIO321", "BIO377"], semester: 7 },
        { id: "MED292", name: "Salud P√∫blica I", prereqs: ["MED279"], semester: 7 },

        // =========================
        // Semestre 8
        // =========================
        { id: "MED295", name: "Patolog√≠a II", prereqs: ["MED294"], semester: 8 },
        { id: "MED293", name: "Salud P√∫blica II", prereqs: ["MED292"], semester: 8 },
        { id: "MED245", name: "Psiquiatr√≠a", prereqs: ["MED131"], semester: 8 },

        // =========================
        // A√±o 5  ‚Üí mapeado a "Semestre 9"
        // Requiere TODO desde Semestre 1 al 8
        // =========================
        { id: "MED281", name: "Otorrinolaringolog√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245"
        ], semester: 9 },
        { id: "MED282", name: "Dermatolog√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245"
        ], semester: 9 },
        { id: "MED283", name: "Urolog√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245"
        ], semester: 9 },
        { id: "MED284", name: "Oftalmolog√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245"
        ], semester: 9 },
        { id: "MED285", name: "Medicina Legal", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245"
        ], semester: 9 },
        { id: "MED297", name: "Pediatr√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245"
        ], semester: 9 },
        { id: "MED298", name: "Obstetricia y Ginecolog√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245"
        ], semester: 9 },

        // =========================
        // A√±o 6 ‚Üí mapeado a "Semestre 10"
        // Requiere Semestres 1‚Äì8 + A√±o 5
        // =========================
        { id: "MED374", name: "Internado de Pediatr√≠a", prereqs: [
          // Semestres 1‚Äì8
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245",
          // A√±o 5
          "MED281","MED282","MED283","MED284","MED285","MED297","MED298"
        ], semester: 10 },
        { id: "MED375", name: "Internado de Cirug√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245",
          "MED281","MED282","MED283","MED284","MED285","MED297","MED298"
        ], semester: 10 },
        { id: "MED376", name: "Internado de Obstetricia y Ginecolog√≠a", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245",
          "MED281","MED282","MED283","MED284","MED285","MED297","MED298"
        ], semester: 10 },

        // =========================
        // A√±o 7 ‚Üí mapeado a "Semestre 11"
        // Requiere Semestres 1‚Äì8 + A√±o 5 + A√±o 6
        // =========================
        { id: "MED300", name: "Internado Electivo", prereqs: [
          // Semestres 1‚Äì8
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245",
          // A√±o 5
          "MED281","MED282","MED283","MED284","MED285","MED297","MED298",
          // A√±o 6
          "MED374","MED375","MED376"
        ], semester: 11 },
        { id: "MED377", name: "Internado de Medicina Interna", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245",
          "MED281","MED282","MED283","MED284","MED285","MED297","MED298",
          "MED374","MED375","MED376"
        ], semester: 11 },
        { id: "MED378", name: "Internado de Medicina Comunitaria", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245",
          "MED281","MED282","MED283","MED284","MED285","MED297","MED298",
          "MED374","MED375","MED376"
        ], semester: 11 },
        { id: "MED380", name: "Internado Integrado", prereqs: [
          "MED016","FMM007","QUI109","BIO130","BIO131","CEG001",
          "MED017","FMF019","QUI024","MOR330","MOR331","CEG002",
          "MED121","BIO376","BIO266","MOR332","MOR333","HUF124",
          "MED122","BIO377","BIO148","BIO242","BIO320","BIO321","MED131","CEG003",
          "MED250","MED257","BIO250","BIO251","MED258","MED278",
          "MED249","MED260","BIO288","MED259","MED279",
          "MED296","MED287","MED244","MED294","MED292",
          "MED295","MED293","MED245",
          "MED281","MED282","MED283","MED284","MED285","MED297","MED298",
          "MED374","MED375","MED376"
        ], semester: 11 },
      ];

      /* =========================================================================
         üß† Helpers de almacenamiento local
         ========================================================================= */
      const STORAGE_KEY = "passedCourses"; // Array de IDs aprobados

      function loadPassed() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          const parsed = raw ? JSON.parse(raw) : [];
          return Array.isArray(parsed) ? new Set(parsed) : new Set();
        } catch {
          return new Set();
        }
      }

      function savePassed(passedSet) {
        const arr = Array.from(passedSet);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
      }

      /* =========================================================================
         üîó L√≥gica de prerrequisitos
         ========================================================================= */
      function isUnlocked(course, passedSet) {
        // Un ramo est√° "desbloqueado" si todos sus prerrequisitos est√°n aprobados
        return course.prereqs.every((reqId) => passedSet.has(reqId));
      }

      function getCourseState(course, passedSet) {
        if (passedSet.has(course.id)) return "approved";
        return isUnlocked(course, passedSet) ? "unlocked" : "locked";
      }

      /* =========================================================================
         üé® Componentes de UI
         ========================================================================= */
      function Pill({ children }) {
        return (
          <span className="inline-flex items-center gap-1 rounded-full border border-pink-200 bg-pink-100/60 px-2 py-0.5 text-xs font-medium text-pink-700">
            {children}
          </span>
        );
      }

      function CourseButton({ course, state, onToggle }) {
        const isApproved = state === "approved";
        const isUnlockedState = state === "unlocked";
        const isLocked = state === "locked";

        const base =
          "w-full text-left rounded-2xl p-4 shadow-sm transition transform-gpu focus:outline-none focus:ring-4 focus:ring-pink-300/60 active:scale-[.99]";
        const visual =
          isApproved
            ? "bg-gradient-to-br from-pink-500 via-rose-500 to-purple-600 text-white shadow-glow"
            : isUnlockedState
            ? "bg-white border-2 border-purple-400 text-purple-700 hover:bg-purple-50"
            : "bg-gray-200 text-gray-500 cursor-not-allowed opacity-70";

        return (
          <button
            type="button"
            className={`${base} ${visual}`}
            onClick={() => (isLocked ? null : onToggle(course))}
            aria-pressed={isApproved}
            aria-disabled={isLocked}
            disabled={isLocked}
            title={
              isApproved
                ? "Aprobado (haz clic para desmarcar)"
                : isUnlockedState
                ? "Desbloqueado (haz clic para marcar como aprobado)"
                : "Bloqueado por prerrequisitos pendientes"
            }
          >
            <div className="flex items-start justify-between gap-3">
              <div>
                <h4 className="text-sm font-semibold sm:text-base">
                  {course.name}
                </h4>
                <p className="mt-1 text-xs sm:text-sm opacity-80">
                  <span className="font-medium">C√≥digo:</span> {course.id}
                </p>
              </div>

              {/* Estado */}
              <div className="flex flex-col items-end gap-1">
                {isApproved ? (
                  <Pill>‚úÖ Aprobado</Pill>
                ) : isUnlockedState ? (
                  <Pill>üü£ Desbloqueado</Pill>
                ) : (
                  <Pill>üîí Bloqueado</Pill>
                )}
              </div>
            </div>

            {/* Prerrequisitos */}
            <div className="mt-3 text-[11px] sm:text-xs">
              {course.prereqs.length === 0 ? (
                <span className="opacity-70">Sin prerrequisitos</span>
              ) : (
                <span className="opacity-80">
                  Prerrequisitos:{" "}
                  <span className="font-medium">
                    {course.prereqs.join(", ")}
                  </span>
                </span>
              )}
            </div>
          </button>
        );
      }

      function SemesterSection({ semester, courses, passedSet, onToggle }) {
        return (
          <section className="rounded-3xl border border-rose-100 bg-gradient-to-br from-pink-100 via-rose-100 to-purple-100/70 p-4 sm:p-6">
            <header className="mb-4 sm:mb-6 flex items-center justify-between">
              <h3 className="text-lg sm:text-xl font-semibold text-purple-800">
                Semestre {semester}
              </h3>
              <span className="text-xs sm:text-sm text-purple-800/80">
                {courses.length} ramo{courses.length !== 1 ? "s" : ""}
              </span>
            </header>

            <div className="grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
              {courses.map((course) => {
                const state = getCourseState(course, passedSet);
                return (
                  <CourseButton
                    key={course.id}
                    course={course}
                    state={state}
                    onToggle={onToggle}
                  />
                );
              })}
            </div>
          </section>
        );
      }

      /* =========================================================================
         üß© Aplicaci√≥n principal
         ========================================================================= */
      function App() {
        const [passed, setPassed] = React.useState(() => loadPassed());

        // Guardar en localStorage cada vez que cambie "passed"
        React.useEffect(() => {
          savePassed(passed);
        }, [passed]);

        const semesters = React.useMemo(() => {
          const uniq = Array.from(new Set(initialCourses.map((c) => c.semester)));
          return uniq.sort((a, b) => a - b);
        }, []);

        const coursesBySemester = React.useMemo(() => {
          const map = new Map();
          for (const s of semesters) map.set(s, []);
          for (const c of initialCourses) map.get(c.semester)?.push(c);
          // Ordenar opcionalmente por nombre dentro de cada semestre
          for (const s of semesters) {
            map.get(s).sort((a, b) => a.name.localeCompare(b.name, "es"));
          }
          return map;
        }, [semesters]);

        function toggleCourse(course) {
          const state = getCourseState(course, passed);
          if (state === "locked") return; // por seguridad
          const next = new Set(passed);
          if (next.has(course.id)) {
            next.delete(course.id);
          } else {
            next.add(course.id);
          }
          setPassed(next);
        }

        function resetProgress() {
          setPassed(new Set());
          localStorage.removeItem(STORAGE_KEY);
        }

        const total = initialCourses.length;
        const done = passed.size;
        const percent = Math.round((done / Math.max(1, total)) * 100);

        return (
          <div className="space-y-8">
            {/* Barra de progreso y acciones */}
            <section className="rounded-3xl border border-pink-100 bg-white p-5 sm:p-6 shadow-sm">
              <div className="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
                <div>
                  <h2 className="text-lg sm:text-xl font-semibold text-purple-800">
                    Tu progreso
                  </h2>
                  <p className="text-sm text-purple-900/80">
                    {done} / {total} ramos aprobados ({percent}%)
                  </p>
                </div>
                <div className="flex items-center gap-3">
                  <button
                    type="button"
                    onClick={resetProgress}
                    className="inline-flex items-center justify-center rounded-xl border-2 border-rose-400 bg-white px-3 py-2 text-sm font-semibold text-rose-700 hover:bg-rose-50 focus:outline-none focus:ring-4 focus:ring-rose-300/60"
                    title="Borrar estados guardados"
                  >
                    Reiniciar progreso
                  </button>
                </div>
              </div>

              {/* Progress bar */}
              <div className="mt-4 h-3 w-full overflow-hidden rounded-full bg-pink-100">
                <div
                  className="h-full bg-gradient-to-r from-pink-500 via-rose-500 to-purple-600 transition-all"
                  style={{ width: `${percent}%` }}
                  role="progressbar"
                  aria-valuenow={percent}
                  aria-valuemin={0}
                  aria-valuemax={100}
                  aria-label="Progreso de ramos aprobados"
                />
              </div>

              <p className="mt-3 text-xs sm:text-sm text-purple-900/70">
                üí° <span className="font-medium">C√≥mo usar:</span> haz clic en un ramo{" "}
                <span className="text-purple-700 font-medium">desbloqueado</span> para marcarlo como{" "}
                <span className="text-rose-700 font-medium">aprobado</span>. Los ramos que dependan de √©l se desbloquear√°n autom√°ticamente.
              </p>
            </section>

            {/* Secciones por semestre */}
            <div className="space-y-6">
              {semesters.map((s) => (
                <SemesterSection
                  key={s}
                  semester={s}
                  courses={coursesBySemester.get(s)}
                  passedSet={passed}
                  onToggle={toggleCourse}
                />
              ))}
            </div>

            {/* Nota de edici√≥n */}
            <footer className="rounded-3xl border border-purple-100 bg-white p-5 sm:p-6 text-sm text-purple-900/80">
              <p className="mb-2 font-medium">üõ†Ô∏è Personaliza tu malla</p>
              <p>
                Edita el array <code className="rounded bg-purple-100/60 px-1 py-0.5">initialCourses</code> en este archivo
                para reflejar tu plan de estudios real. Mant√©n los{" "}
                <span className="font-medium">IDs</span> consistentes y ajusta{" "}
                <span className="font-medium">prereqs</span> y <span className="font-medium">semester</span> seg√∫n corresponda.
              </p>
            </footer>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
